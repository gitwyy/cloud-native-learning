# ğŸ™ GitHub Actions CI/CD å®è·µæŒ‡å—

> å®Œæ•´çš„GitHub Actionså·¥ä½œæµé…ç½®å’Œå®è·µæ€»ç»“

## ğŸ¯ å®è·µç›®æ ‡

é€šè¿‡æœ¬æ¬¡å®è·µï¼Œæ‚¨å°†æŒæ¡ï¼š
- GitHub Actionså·¥ä½œæµçš„é…ç½®å’Œä½¿ç”¨
- è‡ªåŠ¨åŒ–æµ‹è¯•ã€æ„å»ºã€éƒ¨ç½²æµç¨‹
- å®¹å™¨é•œåƒçš„è‡ªåŠ¨æ„å»ºå’Œæ¨é€
- å®‰å…¨æ‰«æå’Œä»£ç è´¨é‡æ£€æŸ¥
- å¤šç¯å¢ƒéƒ¨ç½²ç­–ç•¥

## âœ… å·²å®Œæˆçš„é…ç½®

### 1. å·¥ä½œæµæ–‡ä»¶ç»“æ„
```
.github/workflows/
â””â”€â”€ sample-app-ci-cd.yml    # ä¸»è¦çš„CI/CDå·¥ä½œæµ
```

### 2. å·¥ä½œæµé˜¶æ®µ
æˆ‘ä»¬çš„GitHub Actionså·¥ä½œæµåŒ…å«ä»¥ä¸‹é˜¶æ®µï¼š

#### ğŸ§ª æµ‹è¯•é˜¶æ®µ (test)
- **å¤šç‰ˆæœ¬æµ‹è¯•**: Node.js 18 å’Œ 20
- **ä¾èµ–å®‰è£…**: ä½¿ç”¨npm ciè¿›è¡Œå¿«é€Ÿå®‰è£…
- **ä»£ç æ£€æŸ¥**: è¿è¡Œlintingï¼ˆå¦‚æœå¯ç”¨ï¼‰
- **å•å…ƒæµ‹è¯•**: æ‰§è¡Œæ‰€æœ‰æµ‹è¯•ç”¨ä¾‹
- **è¦†ç›–ç‡æŠ¥å‘Š**: ç”Ÿæˆå¹¶ä¸Šä¼ ä»£ç è¦†ç›–ç‡

#### ğŸ”’ å®‰å…¨æ‰«æ (security)
- **ä¾èµ–å®¡è®¡**: npm auditæ£€æŸ¥å·²çŸ¥æ¼æ´
- **å®‰å…¨æ‰«æ**: æ£€æŸ¥ä¾èµ–åŒ…çš„å®‰å…¨é—®é¢˜

#### ğŸ³ æ„å»ºæ¨é€ (build-and-push)
- **Dockeræ„å»º**: å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–é•œåƒ
- **é•œåƒæ¨é€**: æ¨é€åˆ°GitHub Container Registry (GHCR)
- **å®¹å™¨æ‰«æ**: ä½¿ç”¨Trivyæ‰«æå®¹å™¨æ¼æ´
- **å®‰å…¨æŠ¥å‘Š**: ä¸Šä¼ æ‰«æç»“æœåˆ°GitHub Security

#### ğŸš€ éƒ¨ç½²é˜¶æ®µ (deploy)
- **æµ‹è¯•ç¯å¢ƒ**: è‡ªåŠ¨éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
- **ç”Ÿäº§ç¯å¢ƒ**: æ‰‹åŠ¨å®¡æ‰¹åéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

## ğŸ“Š å·¥ä½œæµç‰¹æ€§

### ğŸ¯ è§¦å‘æ¡ä»¶
```yaml
on:
  push:
    branches: [ main ]
    paths:
      - 'projects/phase4-production/cicd-pipeline/sample-app/**'
  pull_request:
    branches: [ main ]
    paths:
      - 'projects/phase4-production/cicd-pipeline/sample-app/**'
```

### ğŸ”§ ç¯å¢ƒå˜é‡
```yaml
env:
  REGISTRY: ghcr.io
  IMAGE_NAME: ${{ github.repository }}/sample-app
  NODE_VERSION: '18'
  APP_PATH: projects/phase4-production/cicd-pipeline/sample-app
```

### ğŸ—ï¸ æ„å»ºä¼˜åŒ–
- **ç¼“å­˜ç­–ç•¥**: npmç¼“å­˜å’ŒDockerå±‚ç¼“å­˜
- **å¹¶è¡Œæ‰§è¡Œ**: æµ‹è¯•çŸ©é˜µå¹¶è¡Œè¿è¡Œ
- **æ¡ä»¶æ‰§è¡Œ**: åªåœ¨mainåˆ†æ”¯æ‰§è¡Œæ„å»ºå’Œéƒ¨ç½²

## ğŸ” å¦‚ä½•æŸ¥çœ‹å·¥ä½œæµè¿è¡Œ

1. **è®¿é—®Actionsé¡µé¢**:
   ```
   https://github.com/gitwyy/cloud-native-learning/actions
   ```

2. **æŸ¥çœ‹å…·ä½“è¿è¡Œ**:
   - ç‚¹å‡»ä»»æ„å·¥ä½œæµè¿è¡Œ
   - æŸ¥çœ‹å„ä¸ªä½œä¸šçš„è¯¦ç»†æ—¥å¿—
   - æ£€æŸ¥æµ‹è¯•ç»“æœå’Œæ„å»ºçŠ¶æ€

3. **æŸ¥çœ‹æ„å»ºçš„é•œåƒ**:
   ```
   https://github.com/gitwyy/cloud-native-learning/pkgs/container/sample-app
   ```

## ğŸ› ï¸ æœ¬åœ°æµ‹è¯•å·¥ä½œæµ

æ‚¨å¯ä»¥ä½¿ç”¨actå·¥å…·åœ¨æœ¬åœ°æµ‹è¯•GitHub Actionsï¼š

```bash
# å®‰è£…act (macOS)
brew install act

# è¿è¡Œæµ‹è¯•ä½œä¸š
act -j test

# è¿è¡Œæ‰€æœ‰ä½œä¸š
act
```

## ğŸ“ˆ ç›‘æ§å’Œä¼˜åŒ–

### æŸ¥çœ‹å·¥ä½œæµæ€§èƒ½
- **è¿è¡Œæ—¶é—´**: ç›‘æ§å„é˜¶æ®µæ‰§è¡Œæ—¶é—´
- **æˆåŠŸç‡**: è·Ÿè¸ªæ„å»ºæˆåŠŸç‡
- **èµ„æºä½¿ç”¨**: ä¼˜åŒ–ç¼“å­˜å’Œå¹¶è¡Œåº¦

### å¸¸è§ä¼˜åŒ–ç­–ç•¥
1. **ç¼“å­˜ä¼˜åŒ–**: åˆç†ä½¿ç”¨npmå’ŒDockerç¼“å­˜
2. **å¹¶è¡Œæ‰§è¡Œ**: åˆ©ç”¨çŸ©é˜µç­–ç•¥å¹¶è¡Œæµ‹è¯•
3. **æ¡ä»¶æ‰§è¡Œ**: é¿å…ä¸å¿…è¦çš„ä½œä¸šè¿è¡Œ
4. **èµ„æºé™åˆ¶**: åˆç†é…ç½®è¶…æ—¶æ—¶é—´

## ğŸ”§ æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜
1. **æµ‹è¯•å¤±è´¥**: æ£€æŸ¥æµ‹è¯•ä»£ç å’Œä¾èµ–
2. **æ„å»ºå¤±è´¥**: éªŒè¯Dockerfileå’Œæ„å»ºä¸Šä¸‹æ–‡
3. **æ¨é€å¤±è´¥**: æ£€æŸ¥GITHUB_TOKENæƒé™
4. **éƒ¨ç½²å¤±è´¥**: éªŒè¯Kubernetesé…ç½®

### è°ƒè¯•æŠ€å·§
```yaml
# æ·»åŠ è°ƒè¯•æ­¥éª¤
- name: Debug info
  run: |
    echo "Event: ${{ github.event_name }}"
    echo "Ref: ${{ github.ref }}"
    echo "SHA: ${{ github.sha }}"
    ls -la
```

## ğŸš€ ä¸‹ä¸€æ­¥æ‰©å±•

### 1. æ·»åŠ æ›´å¤šæµ‹è¯•
- é›†æˆæµ‹è¯•
- ç«¯åˆ°ç«¯æµ‹è¯•
- æ€§èƒ½æµ‹è¯•

### 2. å¢å¼ºå®‰å…¨æ€§
- ä»£ç ç­¾å
- æ¼æ´æ‰«æ
- åˆè§„æ£€æŸ¥

### 3. éƒ¨ç½²ç­–ç•¥
- è“ç»¿éƒ¨ç½²
- é‡‘ä¸é›€å‘å¸ƒ
- æ»šåŠ¨æ›´æ–°

### 4. ç›‘æ§é›†æˆ
- éƒ¨ç½²é€šçŸ¥
- æ€§èƒ½ç›‘æ§
- é”™è¯¯è¿½è¸ª

## ğŸ“š å­¦ä¹ èµ„æº

- [GitHub Actionså®˜æ–¹æ–‡æ¡£](https://docs.github.com/en/actions)
- [å·¥ä½œæµè¯­æ³•å‚è€ƒ](https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions)
- [GitHub Container Registry](https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-container-registry)
- [å®‰å…¨æœ€ä½³å®è·µ](https://docs.github.com/en/actions/security-guides)

---

**æ­å–œï¼** ğŸ‰ æ‚¨å·²ç»æˆåŠŸé…ç½®äº†å®Œæ•´çš„GitHub Actions CI/CDæµæ°´çº¿ï¼

ç°åœ¨å¯ä»¥ç»§ç»­å­¦ä¹ å…¶ä»–CI/CDå¹³å°æˆ–è¿›å…¥å®‰å…¨åŠ å›ºé˜¶æ®µã€‚
