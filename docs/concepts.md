# ğŸ§  äº‘åŸç”Ÿæ ¸å¿ƒæ¦‚å¿µè¯¦è§£

> æ·±å…¥ç†è§£äº‘åŸç”ŸæŠ€æœ¯çš„åŸºç¡€æ¦‚å¿µå’Œæ ¸å¿ƒåŸç†

## ğŸ“– ç›®å½•

- [ä»€ä¹ˆæ˜¯äº‘åŸç”Ÿ](#ä»€ä¹ˆæ˜¯äº‘åŸç”Ÿ)
- [å®¹å™¨åŒ–æŠ€æœ¯](#å®¹å™¨åŒ–æŠ€æœ¯)
- [å¾®æœåŠ¡æ¶æ„](#å¾®æœåŠ¡æ¶æ„)
- [å®¹å™¨ç¼–æ’](#å®¹å™¨ç¼–æ’)
- [æœåŠ¡ç½‘æ ¼](#æœåŠ¡ç½‘æ ¼)
- [å¯è§‚æµ‹æ€§](#å¯è§‚æµ‹æ€§)
- [DevOpså’ŒCI/CD](#devopså’Œcicd)
- [åŸºç¡€è®¾æ–½å³ä»£ç ](#åŸºç¡€è®¾æ–½å³ä»£ç )
- [äº‘åŸç”Ÿå®‰å…¨](#äº‘åŸç”Ÿå®‰å…¨)

---

## ğŸŒ¤ï¸ ä»€ä¹ˆæ˜¯äº‘åŸç”Ÿ

### å®šä¹‰

**äº‘åŸç”Ÿ**æ˜¯ä¸€å¥—æŠ€æœ¯ä½“ç³»å’Œæ–¹æ³•è®ºï¼Œä¸“é—¨ä¸ºåœ¨äº‘è®¡ç®—ç¯å¢ƒä¸­æ„å»ºå’Œè¿è¡Œå¯å¼¹æ€§æ‰©å±•çš„åº”ç”¨è€Œè®¾è®¡ã€‚

### CNCFå®˜æ–¹å®šä¹‰

> äº‘åŸç”ŸæŠ€æœ¯æœ‰åˆ©äºå„ç»„ç»‡åœ¨å…¬æœ‰äº‘ã€ç§æœ‰äº‘å’Œæ··åˆäº‘ç­‰æ–°å‹åŠ¨æ€ç¯å¢ƒä¸­ï¼Œæ„å»ºå’Œè¿è¡Œå¯å¼¹æ€§æ‰©å±•çš„åº”ç”¨ã€‚äº‘åŸç”Ÿçš„ä»£è¡¨æŠ€æœ¯åŒ…æ‹¬å®¹å™¨ã€æœåŠ¡ç½‘æ ¼ã€å¾®æœåŠ¡ã€ä¸å¯å˜åŸºç¡€è®¾æ–½å’Œå£°æ˜å¼APIã€‚

### æ ¸å¿ƒç‰¹å¾

```mermaid
mindmap
  root((äº‘åŸç”Ÿ))
    å¼¹æ€§ä¼¸ç¼©
      è‡ªåŠ¨æ‰©ç¼©å®¹
      è´Ÿè½½å‡è¡¡
      æ•…éšœè½¬ç§»
    å¾®æœåŠ¡åŒ–
      æœåŠ¡æ‹†åˆ†
      ç‹¬ç«‹éƒ¨ç½²
      æŠ€æœ¯æ ˆå¤šæ ·åŒ–
    å®¹å™¨åŒ–
      è½»é‡çº§è™šæ‹ŸåŒ–
      ä¸€è‡´æ€§ç¯å¢ƒ
      å¿«é€Ÿå¯åŠ¨
    è‡ªåŠ¨åŒ–
      CI/CDæµæ°´çº¿
      åŸºç¡€è®¾æ–½å³ä»£ç 
      è‡ªåŠ¨ç›‘æ§å‘Šè­¦
    å¯è§‚æµ‹æ€§
      æŒ‡æ ‡ç›‘æ§
      æ—¥å¿—åˆ†æ
      é“¾è·¯è¿½è¸ª
```

### äº‘åŸç”Ÿçš„ä¼˜åŠ¿

| ä¼ ç»Ÿåº”ç”¨ | äº‘åŸç”Ÿåº”ç”¨ | ä¼˜åŠ¿ |
|----------|-----------|------|
| å•ä½“æ¶æ„ | å¾®æœåŠ¡æ¶æ„ | æ›´å¥½çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ |
| æ‰‹åŠ¨éƒ¨ç½² | è‡ªåŠ¨åŒ–CI/CD | æ›´å¿«çš„å‘å¸ƒé€Ÿåº¦å’Œæ›´é«˜çš„è´¨é‡ |
| é™æ€é…ç½® | åŠ¨æ€ä¼¸ç¼© | æ›´å¥½çš„èµ„æºåˆ©ç”¨ç‡ |
| æœ‰é™ç›‘æ§ | å…¨é¢å¯è§‚æµ‹æ€§ | æ›´å¿«çš„é—®é¢˜å‘ç°å’Œè§£å†³ |

---

## ğŸ“¦ å®¹å™¨åŒ–æŠ€æœ¯

### å®¹å™¨ vs è™šæ‹Ÿæœº

```mermaid
graph TB
    subgraph "è™šæ‹Ÿæœºæ¶æ„"
        HW1[ç‰©ç†ç¡¬ä»¶]
        OS1[å®¿ä¸»æ“ä½œç³»ç»Ÿ]
        HYP[è™šæ‹ŸåŒ–å±‚ Hypervisor]
        VM1[è™šæ‹Ÿæœº1<br/>Guest OS + App1]
        VM2[è™šæ‹Ÿæœº2<br/>Guest OS + App2]
        VM3[è™šæ‹Ÿæœº3<br/>Guest OS + App3]
    end
    
    subgraph "å®¹å™¨æ¶æ„"
        HW2[ç‰©ç†ç¡¬ä»¶]
        OS2[å®¿ä¸»æ“ä½œç³»ç»Ÿ]
        CE[å®¹å™¨å¼•æ“ Docker]
        C1[å®¹å™¨1<br/>App1]
        C2[å®¹å™¨2<br/>App2]  
        C3[å®¹å™¨3<br/>App3]
    end
    
    HW1 --> OS1
    OS1 --> HYP
    HYP --> VM1
    HYP --> VM2
    HYP --> VM3
    
    HW2 --> OS2
    OS2 --> CE
    CE --> C1
    CE --> C2
    CE --> C3
```

### å®¹å™¨æ ¸å¿ƒæ¦‚å¿µ

#### 1. Linuxå‘½åç©ºé—´ (Namespaces)

ä¸ºè¿›ç¨‹æä¾›éš”ç¦»çš„æ‰§è¡Œç¯å¢ƒï¼š

| å‘½åç©ºé—´ç±»å‹ | éš”ç¦»å†…å®¹ | ä½œç”¨ |
|-------------|----------|------|
| **PID** | è¿›ç¨‹ID | å®¹å™¨å†…è¿›ç¨‹çœ‹ä¸åˆ°å®¿ä¸»æœºå…¶ä»–è¿›ç¨‹ |
| **NET** | ç½‘ç»œ | å®¹å™¨æ‹¥æœ‰ç‹¬ç«‹çš„ç½‘ç»œæ ˆ |
| **IPC** | è¿›ç¨‹é—´é€šä¿¡ | éš”ç¦»ä¿¡å·é‡ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰ |
| **MNT** | æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹ | å®¹å™¨æ‹¥æœ‰ç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿè§†å›¾ |
| **UTS** | ä¸»æœºåå’ŒåŸŸå | å®¹å™¨å¯ä»¥æœ‰ç‹¬ç«‹çš„ä¸»æœºå |
| **USER** | ç”¨æˆ·å’Œç”¨æˆ·ç»„ | ç”¨æˆ·IDæ˜ å°„å’Œæƒé™éš”ç¦» |

#### 2. æ§åˆ¶ç»„ (Cgroups)

èµ„æºé™åˆ¶å’Œç›‘æ§ï¼š

```bash
# CPUé™åˆ¶ç¤ºä¾‹
docker run --cpus="1.5" nginx

# å†…å­˜é™åˆ¶ç¤ºä¾‹  
docker run --memory="512m" nginx

# IOé™åˆ¶ç¤ºä¾‹
docker run --device-read-bps /dev/sda:1mb nginx
```

#### 3. å®¹å™¨é•œåƒ

**åˆ†å±‚å­˜å‚¨æ¶æ„**ï¼š

```mermaid
graph TB
    App[åº”ç”¨å±‚<br/>your-app:latest]
    Runtime[è¿è¡Œæ—¶å±‚<br/>node:16-alpine]
    OS[æ“ä½œç³»ç»Ÿå±‚<br/>alpine:3.14]
    Scratch[åŸºç¡€å±‚<br/>scratch]
    
    App --> Runtime
    Runtime --> OS
    OS --> Scratch
    
    style App fill:#e1f5fe
    style Runtime fill:#f3e5f5
    style OS fill:#e8f5e8
    style Scratch fill:#fff3e0
```

**å†™æ—¶å¤åˆ¶ï¼ˆCOWï¼‰æœºåˆ¶**ï¼š
- å¤šä¸ªå®¹å™¨å…±äº«ç›¸åŒçš„é•œåƒå±‚
- åªæœ‰åœ¨å†™å…¥æ—¶æ‰åˆ›å»ºæ–°çš„å±‚
- å¤§å¹…å‡å°‘å­˜å‚¨ç©ºé—´å’Œå¯åŠ¨æ—¶é—´

### Dockeræ ¸å¿ƒç»„ä»¶

```mermaid
graph TB
    Client[Docker Client<br/>dockerå‘½ä»¤]
    Daemon[Docker Daemon<br/>dockerd]
    Images[Images<br/>é•œåƒä»“åº“]
    Containers[Containers<br/>è¿è¡Œä¸­çš„å®¹å™¨]
    Registry[Docker Registry<br/>é•œåƒæ³¨å†Œä¸­å¿ƒ]
    
    Client -.->|REST API| Daemon
    Daemon --> Images
    Daemon --> Containers
    Daemon <-.->|pull/push| Registry
```

---

## ğŸ—ï¸ å¾®æœåŠ¡æ¶æ„

### å¾®æœåŠ¡ vs å•ä½“æ¶æ„

#### å•ä½“æ¶æ„
```mermaid
graph TB
    UI[ç”¨æˆ·ç•Œé¢]
    BL[ä¸šåŠ¡é€»è¾‘å±‚<br/>ç”¨æˆ·ç®¡ç†+å•†å“ç®¡ç†+è®¢å•ç®¡ç†+æ”¯ä»˜å¤„ç†]
    DB[(å•ä¸€æ•°æ®åº“)]
    
    UI --> BL
    BL --> DB
    
    style BL fill:#ffcdd2
```

#### å¾®æœåŠ¡æ¶æ„
```mermaid
graph TB
    Gateway[APIç½‘å…³]
    
    subgraph "ç”¨æˆ·æœåŠ¡"
        UserUI[ç”¨æˆ·ç•Œé¢]
        UserAPI[ç”¨æˆ·API]
        UserDB[(ç”¨æˆ·æ•°æ®åº“)]
    end
    
    subgraph "å•†å“æœåŠ¡"
        ProductUI[å•†å“ç•Œé¢]  
        ProductAPI[å•†å“API]
        ProductDB[(å•†å“æ•°æ®åº“)]
    end
    
    subgraph "è®¢å•æœåŠ¡"
        OrderUI[è®¢å•ç•Œé¢]
        OrderAPI[è®¢å•API]
        OrderDB[(è®¢å•æ•°æ®åº“)]
    end
    
    subgraph "æ”¯ä»˜æœåŠ¡"
        PaymentAPI[æ”¯ä»˜API]
        PaymentDB[(æ”¯ä»˜æ•°æ®åº“)]
    end
    
    Gateway --> UserAPI
    Gateway --> ProductAPI
    Gateway --> OrderAPI
    Gateway --> PaymentAPI
    
    UserUI --> UserAPI
    ProductUI --> ProductAPI
    OrderUI --> OrderAPI
    
    UserAPI --> UserDB
    ProductAPI --> ProductDB
    OrderAPI --> OrderDB
    PaymentAPI --> PaymentDB
    
    OrderAPI -.->|è°ƒç”¨| PaymentAPI
    OrderAPI -.->|è°ƒç”¨| UserAPI
```

### å¾®æœåŠ¡è®¾è®¡åŸåˆ™

#### 1. å•ä¸€èŒè´£åŸåˆ™
æ¯ä¸ªå¾®æœåŠ¡åªè´Ÿè´£ä¸€ä¸ªä¸šåŠ¡åŠŸèƒ½ï¼š
- âœ… ç”¨æˆ·æœåŠ¡åªå¤„ç†ç”¨æˆ·ç›¸å…³æ“ä½œ
- âœ… è®¢å•æœåŠ¡åªå¤„ç†è®¢å•ç›¸å…³æ“ä½œ
- âŒ é¿å…ä¸€ä¸ªæœåŠ¡å¤„ç†å¤šä¸ªä¸ç›¸å…³çš„ä¸šåŠ¡

#### 2. æœåŠ¡è‡ªæ²»
```yaml
# å¾®æœåŠ¡è‡ªæ²»ç‰¹å¾
independence:
  data: "æ¯ä¸ªæœåŠ¡æ‹¥æœ‰ç‹¬ç«‹çš„æ•°æ®åº“"
  deployment: "å¯ä»¥ç‹¬ç«‹éƒ¨ç½²å’Œå‡çº§"
  scaling: "å¯ä»¥ç‹¬ç«‹æ‰©ç¼©å®¹"
  technology: "å¯ä»¥é€‰æ‹©ä¸åŒçš„æŠ€æœ¯æ ˆ"
  team: "å¯ä»¥ç”±ä¸åŒå›¢é˜Ÿç»´æŠ¤"
```

#### 3. å»ä¸­å¿ƒåŒ–æ²»ç†
- **æ•°æ®å»ä¸­å¿ƒåŒ–**ï¼šæ¯ä¸ªæœåŠ¡ç®¡ç†è‡ªå·±çš„æ•°æ®
- **æŠ€æœ¯å»ä¸­å¿ƒåŒ–**ï¼šæœåŠ¡å¯ä»¥é€‰æ‹©æœ€é€‚åˆçš„æŠ€æœ¯æ ˆ
- **æ²»ç†å»ä¸­å¿ƒåŒ–**ï¼šæœåŠ¡å›¢é˜Ÿæ‹¥æœ‰æŠ€æœ¯å†³ç­–æƒ

### å¾®æœåŠ¡é—´é€šä¿¡

#### åŒæ­¥é€šä¿¡
```mermaid
sequenceDiagram
    participant Client
    participant OrderService
    participant UserService
    participant PaymentService
    
    Client->>OrderService: åˆ›å»ºè®¢å•è¯·æ±‚
    OrderService->>UserService: éªŒè¯ç”¨æˆ·ä¿¡æ¯
    UserService-->>OrderService: ç”¨æˆ·éªŒè¯ç»“æœ
    OrderService->>PaymentService: å¤„ç†æ”¯ä»˜
    PaymentService-->>OrderService: æ”¯ä»˜ç»“æœ
    OrderService-->>Client: è®¢å•åˆ›å»ºç»“æœ
```

#### å¼‚æ­¥é€šä¿¡
```mermaid
graph LR
    OrderService[è®¢å•æœåŠ¡]
    Queue[æ¶ˆæ¯é˜Ÿåˆ—<br/>RabbitMQ/Kafka]
    EmailService[é‚®ä»¶æœåŠ¡]
    SMSService[çŸ­ä¿¡æœåŠ¡]
    InventoryService[åº“å­˜æœåŠ¡]
    
    OrderService -->|å‘å¸ƒäº‹ä»¶| Queue
    Queue -->|è®¢é˜…| EmailService
    Queue -->|è®¢é˜…| SMSService
    Queue -->|è®¢é˜…| InventoryService
```

---

## âš™ï¸ å®¹å™¨ç¼–æ’

### ä¸ºä»€ä¹ˆéœ€è¦å®¹å™¨ç¼–æ’

å•ç‹¬ä½¿ç”¨Dockerçš„é™åˆ¶ï¼š
- âŒ æ‰‹åŠ¨ç®¡ç†å¤§é‡å®¹å™¨
- âŒ å®¹å™¨æ•…éšœåéœ€è¦æ‰‹åŠ¨é‡å¯
- âŒ è´Ÿè½½å‡è¡¡éœ€è¦é¢å¤–é…ç½®
- âŒ æ»šåŠ¨æ›´æ–°å›°éš¾
- âŒ é…ç½®ç®¡ç†å¤æ‚

### Kubernetesæ¶æ„

```mermaid
graph TB
    subgraph "æ§åˆ¶å¹³é¢ Control Plane"
        APIServer[API Server<br/>é›†ç¾¤ç®¡ç†å…¥å£]
        etcd[(etcd<br/>é›†ç¾¤çŠ¶æ€å­˜å‚¨)]
        Scheduler[è°ƒåº¦å™¨<br/>Podè°ƒåº¦å†³ç­–]
        Controller[æ§åˆ¶å™¨ç®¡ç†å™¨<br/>èµ„æºçŠ¶æ€ç®¡ç†]
    end
    
    subgraph "å·¥ä½œèŠ‚ç‚¹1 Worker Node"
        kubelet1[kubelet<br/>èŠ‚ç‚¹ä»£ç†]
        kube-proxy1[kube-proxy<br/>ç½‘ç»œä»£ç†]
        CRI1[å®¹å™¨è¿è¡Œæ—¶<br/>Docker/containerd]
        Pod1[Pod1]
        Pod2[Pod2]
    end
    
    subgraph "å·¥ä½œèŠ‚ç‚¹2 Worker Node"
        kubelet2[kubelet<br/>èŠ‚ç‚¹ä»£ç†]
        kube-proxy2[kube-proxy<br/>ç½‘ç»œä»£ç†] 
        CRI2[å®¹å™¨è¿è¡Œæ—¶<br/>Docker/containerd]
        Pod3[Pod3]
        Pod4[Pod4]
    end
    
    APIServer <--> etcd
    APIServer <--> Scheduler
    APIServer <--> Controller
    
    kubelet1 <--> APIServer
    kubelet2 <--> APIServer
    
    kubelet1 --> CRI1
    kubelet2 --> CRI2
    
    CRI1 --> Pod1
    CRI1 --> Pod2
    CRI2 --> Pod3
    CRI2 --> Pod4
```

### Kubernetesæ ¸å¿ƒæ¦‚å¿µ

#### 1. Pod - æœ€å°éƒ¨ç½²å•å…ƒ
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: web-app
  labels:
    app: web
spec:
  containers:
  - name: web-container
    image: nginx:1.20
    ports:
    - containerPort: 80
    resources:
      requests:
        memory: "64Mi"
        cpu: "250m"
      limits:
        memory: "128Mi"
        cpu: "500m"
```

**Podç‰¹å¾**ï¼š
- Podå†…å®¹å™¨å…±äº«ç½‘ç»œå’Œå­˜å‚¨
- Podæ˜¯åŸå­è°ƒåº¦å•ä½
- Podé€šå¸¸åªåŒ…å«ä¸€ä¸ªä¸»å®¹å™¨

#### 2. Deployment - åº”ç”¨éƒ¨ç½²ç®¡ç†
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web-deployment
spec:
  replicas: 3
  selector:
    matchLabels:
      app: web
  template:
    metadata:
      labels:
        app: web
    spec:
      containers:
      - name: web
        image: nginx:1.20
        ports:
        - containerPort: 80
```

**DeploymentåŠŸèƒ½**ï¼š
- ç®¡ç†Podå‰¯æœ¬æ•°é‡
- æ»šåŠ¨æ›´æ–°å’Œå›æ»š
- æ‰©ç¼©å®¹ç®¡ç†
- è‡ªæ„ˆèƒ½åŠ›

#### 3. Service - æœåŠ¡å‘ç°
```mermaid
graph TB
    subgraph "Service: web-service"
        Endpoint1[10.244.1.2:80]
        Endpoint2[10.244.2.3:80] 
        Endpoint3[10.244.1.4:80]
    end
    
    subgraph "Pods"
        Pod1[web-pod-1<br/>10.244.1.2]
        Pod2[web-pod-2<br/>10.244.2.3]
        Pod3[web-pod-3<br/>10.244.1.4]
    end
    
    Client[å®¢æˆ·ç«¯è¯·æ±‚] --> Service
    Service --> Pod1
    Service --> Pod2
    Service --> Pod3
    
    Endpoint1 -.-> Pod1
    Endpoint2 -.-> Pod2  
    Endpoint3 -.-> Pod3
```

#### Serviceç±»å‹å¯¹æ¯”

| Serviceç±»å‹ | ç”¨é€” | è®¿é—®æ–¹å¼ | é€‚ç”¨åœºæ™¯ |
|------------|------|----------|----------|
| **ClusterIP** | é›†ç¾¤å†…è®¿é—® | é›†ç¾¤å†…IP | å¾®æœåŠ¡é—´é€šä¿¡ |
| **NodePort** | èŠ‚ç‚¹ç«¯å£è®¿é—® | èŠ‚ç‚¹IP:NodePort | å¼€å‘æµ‹è¯•ç¯å¢ƒ |
| **LoadBalancer** | äº‘è´Ÿè½½å‡è¡¡å™¨ | å¤–éƒ¨IP | ç”Ÿäº§ç¯å¢ƒå¤–éƒ¨è®¿é—® |
| **ExternalName** | å¤–éƒ¨æœåŠ¡æ˜ å°„ | DNSåç§° | è®¿é—®å¤–éƒ¨æœåŠ¡ |

---

## ğŸ•¸ï¸ æœåŠ¡ç½‘æ ¼

### ä»€ä¹ˆæ˜¯æœåŠ¡ç½‘æ ¼

**æœåŠ¡ç½‘æ ¼ï¼ˆService Meshï¼‰**æ˜¯ä¸€ä¸ªä¸“é—¨å¤„ç†æœåŠ¡é—´é€šä¿¡çš„åŸºç¡€è®¾æ–½å±‚ï¼Œé€šè¿‡è¾¹è½¦ä»£ç†ï¼ˆSidecar Proxyï¼‰æ¨¡å¼ä¸ºå¾®æœåŠ¡æä¾›é€šä¿¡ã€å®‰å…¨ã€è§‚æµ‹ç­‰èƒ½åŠ›ã€‚

```mermaid
graph TB
    subgraph "ä¼ ç»Ÿå¾®æœåŠ¡æ¶æ„"
        ServiceA1[æœåŠ¡A<br/>ä¸šåŠ¡é€»è¾‘+ç½‘ç»œé€»è¾‘]
        ServiceB1[æœåŠ¡B<br/>ä¸šåŠ¡é€»è¾‘+ç½‘ç»œé€»è¾‘]
        ServiceC1[æœåŠ¡C<br/>ä¸šåŠ¡é€»è¾‘+ç½‘ç»œé€»è¾‘]
        
        ServiceA1 <--> ServiceB1
        ServiceB1 <--> ServiceC1
        ServiceA1 <--> ServiceC1
    end
    
    subgraph "æœåŠ¡ç½‘æ ¼æ¶æ„"
        subgraph "æœåŠ¡A Pod"
            ServiceA2[æœåŠ¡A<br/>çº¯ä¸šåŠ¡é€»è¾‘]
            ProxyA[Envoy<br/>Sidecar]
        end
        
        subgraph "æœåŠ¡B Pod"
            ServiceB2[æœåŠ¡B<br/>çº¯ä¸šåŠ¡é€»è¾‘]
            ProxyB[Envoy<br/>Sidecar]
        end
        
        subgraph "æœåŠ¡C Pod"
            ServiceC2[æœåŠ¡C<br/>çº¯ä¸šåŠ¡é€»è¾‘]
            ProxyC[Envoy<br/>Sidecar]
        end
        
        ServiceA2 --- ProxyA
        ServiceB2 --- ProxyB
        ServiceC2 --- ProxyC
        
        ProxyA <--> ProxyB
        ProxyB <--> ProxyC
        ProxyA <--> ProxyC
    end
```

### Istioæ¶æ„

```mermaid
graph TB
    subgraph "æ§åˆ¶å¹³é¢ Control Plane"
        Pilot[Pilot<br/>æœåŠ¡å‘ç°å’Œé…ç½®]
        Citadel[Citadel<br/>å®‰å…¨å’Œè¯ä¹¦ç®¡ç†] 
        Galley[Galley<br/>é…ç½®éªŒè¯å’Œåˆ†å‘]
        Mixer[Mixer<br/>ç­–ç•¥å’Œé¥æµ‹]
    end
    
    subgraph "æ•°æ®å¹³é¢ Data Plane"
        subgraph "åº”ç”¨Pod"
            App1[åº”ç”¨å®¹å™¨]
            Envoy1[Envoy Sidecar]
        end
        
        subgraph "åº”ç”¨Pod"
            App2[åº”ç”¨å®¹å™¨]
            Envoy2[Envoy Sidecar]
        end
        
        subgraph "åº”ç”¨Pod"
            App3[åº”ç”¨å®¹å™¨]
            Envoy3[Envoy Sidecar]
        end
    end
    
    Pilot --> Envoy1
    Pilot --> Envoy2
    Pilot --> Envoy3
    
    Citadel --> Envoy1
    Citadel --> Envoy2
    Citadel --> Envoy3
    
    Envoy1 <--> Envoy2
    Envoy2 <--> Envoy3
    Envoy1 <--> Envoy3
```

### æœåŠ¡ç½‘æ ¼æ ¸å¿ƒåŠŸèƒ½

#### 1. æµé‡ç®¡ç†
```yaml
# è™šæ‹ŸæœåŠ¡é…ç½®ç¤ºä¾‹
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: reviews
spec:
  hosts:
  - reviews
  http:
  - match:
    - headers:
        end-user:
          exact: jason
    route:
    - destination:
        host: reviews
        subset: v2
  - route:
    - destination:
        host: reviews
        subset: v1
```

#### 2. å®‰å…¨ç­–ç•¥
```yaml
# mTLSç­–ç•¥é…ç½®
apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: default
spec:
  mtls:
    mode: STRICT
```

#### 3. å¯è§‚æµ‹æ€§
- **æŒ‡æ ‡æ”¶é›†**ï¼šè‡ªåŠ¨æ”¶é›†HTTPã€gRPCã€TCPæŒ‡æ ‡
- **åˆ†å¸ƒå¼è¿½è¸ª**ï¼šè¯·æ±‚è°ƒç”¨é“¾è‡ªåŠ¨è¿½è¸ª
- **è®¿é—®æ—¥å¿—**ï¼šè¯¦ç»†çš„è¯·æ±‚è®¿é—®è®°å½•

---

## ğŸ“Š å¯è§‚æµ‹æ€§

### å¯è§‚æµ‹æ€§ä¸‰å¤§æ”¯æŸ±

```mermaid
graph TB
    subgraph "Metrics æŒ‡æ ‡"
        Counter[è®¡æ•°å™¨<br/>è¯·æ±‚æ€»æ•°ã€é”™è¯¯æ€»æ•°]
        Gauge[è®¡é‡å™¨<br/>CPUä½¿ç”¨ç‡ã€å†…å­˜ä½¿ç”¨é‡]
        Histogram[ç›´æ–¹å›¾<br/>å“åº”æ—¶é—´åˆ†å¸ƒ]
        Summary[æ‘˜è¦<br/>åˆ†ä½æ•°ç»Ÿè®¡]
    end
    
    subgraph "Logs æ—¥å¿—"
        Structured[ç»“æ„åŒ–æ—¥å¿—<br/>JSONæ ¼å¼]
        Unstructured[éç»“æ„åŒ–æ—¥å¿—<br/>çº¯æ–‡æœ¬]
        Events[äº‹ä»¶æ—¥å¿—<br/>å®¡è®¡ã€æ“ä½œè®°å½•]
    end
    
    subgraph "Traces é“¾è·¯"
        Span[æ“ä½œè·¨åº¦<br/>å•ä¸ªæ“ä½œçš„æ—¶é—´æ®µ]
        Trace[å®Œæ•´é“¾è·¯<br/>è¯·æ±‚çš„å®Œæ•´è°ƒç”¨è·¯å¾„]
        Context[ä¸Šä¸‹æ–‡ä¼ æ’­<br/>è·¨æœåŠ¡çš„è¿½è¸ªä¿¡æ¯]
    end
    
    Observability[å¯è§‚æµ‹æ€§]
    Observability --> Counter
    Observability --> Structured
    Observability --> Span
```

### ç›‘æ§æ¶æ„è®¾è®¡

```mermaid
graph TB
    subgraph "æ•°æ®æ”¶é›†å±‚"
        Apps[åº”ç”¨ç¨‹åº]
        Exporters[Exporters<br/>Node/cAdvisor/etc]
        ServiceMesh[æœåŠ¡ç½‘æ ¼<br/>Envoy Proxy]
    end
    
    subgraph "å­˜å‚¨å±‚"
        Prometheus[(Prometheus<br/>æŒ‡æ ‡å­˜å‚¨)]
        Elasticsearch[(Elasticsearch<br/>æ—¥å¿—å­˜å‚¨)]
        Jaeger[(Jaeger<br/>é“¾è·¯å­˜å‚¨)]
    end
    
    subgraph "å¯è§†åŒ–å±‚"
        Grafana[Grafana<br/>æŒ‡æ ‡å¯è§†åŒ–]
        Kibana[Kibana<br/>æ—¥å¿—åˆ†æ]
        JaegerUI[Jaeger UI<br/>é“¾è·¯è¿½è¸ª]
    end
    
    subgraph "å‘Šè­¦å±‚"
        AlertManager[AlertManager<br/>å‘Šè­¦ç®¡ç†]
        PagerDuty[PagerDuty<br/>äº‹ä»¶å“åº”]
        Slack[Slack<br/>é€šçŸ¥é›†æˆ]
    end
    
    Apps --> Prometheus
    Exporters --> Prometheus
    ServiceMesh --> Prometheus
    ServiceMesh --> Jaeger
    Apps --> Elasticsearch
    
    Prometheus --> Grafana
    Prometheus --> AlertManager
    Elasticsearch --> Kibana
    Jaeger --> JaegerUI
    
    AlertManager --> PagerDuty
    AlertManager --> Slack
```

### å››ä¸ªé»„é‡‘ä¿¡å·

| ä¿¡å· | å®šä¹‰ | ç›‘æ§æŒ‡æ ‡ | å‘Šè­¦é˜ˆå€¼ç¤ºä¾‹ |
|------|------|----------|-------------|
| **å»¶è¿Ÿ Latency** | è¯·æ±‚å“åº”æ—¶é—´ | P50ã€P95ã€P99å“åº”æ—¶é—´ | P95 > 500ms |
| **æµé‡ Traffic** | è¯·æ±‚é€Ÿç‡ | QPSã€RPS | QPSä¸‹é™ > 50% |
| **é”™è¯¯ Errors** | é”™è¯¯ç‡ | 4xxã€5xxé”™è¯¯ç‡ | é”™è¯¯ç‡ > 5% |
| **é¥±å’Œåº¦ Saturation** | èµ„æºä½¿ç”¨ç‡ | CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡ | CPU > 80% |

---

## ğŸ”„ DevOpså’ŒCI/CD

### DevOpsæ–‡åŒ–

```mermaid
graph TB
    subgraph "ä¼ ç»Ÿæ¨¡å¼"
        Dev1[å¼€å‘å›¢é˜Ÿ<br/>ç¼–å†™ä»£ç ]
        Ops1[è¿ç»´å›¢é˜Ÿ<br/>éƒ¨ç½²è¿ç»´]
        Wall1[ä¿¡æ¯å£å’]
        
        Dev1 -.->|äº¤æ¥| Wall1
        Wall1 -.->|éƒ¨ç½²| Ops1
    end
    
    subgraph "DevOpsæ¨¡å¼" 
        DevOps[DevOpså›¢é˜Ÿ<br/>å¼€å‘+è¿ç»´ä¸€ä½“åŒ–]
        
        subgraph "è‡ªåŠ¨åŒ–å·¥å…·é“¾"
            CI[æŒç»­é›†æˆ]
            CD[æŒç»­éƒ¨ç½²]
            Monitoring[ç›‘æ§å‘Šè­¦]
            IaC[åŸºç¡€è®¾æ–½å³ä»£ç ]
        end
        
        DevOps --> CI
        DevOps --> CD
        DevOps --> Monitoring
        DevOps --> IaC
    end
```

### CI/CDæµæ°´çº¿

```mermaid
graph LR
    subgraph "æŒç»­é›†æˆ CI"
        Code[ä»£ç æäº¤]
        Build[æ„å»º]
        Test[æµ‹è¯•]
        Package[æ‰“åŒ…]
    end
    
    subgraph "æŒç»­éƒ¨ç½² CD"
        Deploy[éƒ¨ç½²]
        Monitor[ç›‘æ§]
        Feedback[åé¦ˆ]
    end
    
    Code --> Build
    Build --> Test
    Test --> Package
    Package --> Deploy
    Deploy --> Monitor
    Monitor --> Feedback
    Feedback -.-> Code
```

#### æµæ°´çº¿é˜¶æ®µè¯¦è§£

1. **ä»£ç è´¨é‡æ£€æŸ¥**
   ```yaml
   stages:
     - lint: "ESLintã€Pylinté™æ€ä»£ç åˆ†æ"
     - security: "å®‰å…¨æ¼æ´æ‰«æ"
     - coverage: "æµ‹è¯•è¦†ç›–ç‡æ£€æŸ¥"
   ```

2. **è‡ªåŠ¨åŒ–æµ‹è¯•**
   ```yaml
   test_pyramid:
     unit_tests: "å•å…ƒæµ‹è¯• - 70%"
     integration_tests: "é›†æˆæµ‹è¯• - 20%"
     e2e_tests: "ç«¯åˆ°ç«¯æµ‹è¯• - 10%"
   ```

3. **éƒ¨ç½²ç­–ç•¥**
   - **è“ç»¿éƒ¨ç½²**ï¼šé›¶åœæœºæ—¶é—´éƒ¨ç½²
   - **é‡‘ä¸é›€å‘å¸ƒ**ï¼šæ¸è¿›å¼æµé‡åˆ‡æ¢
   - **æ»šåŠ¨æ›´æ–°**ï¼šé€æ­¥æ›¿æ¢æ—§ç‰ˆæœ¬

---

## ğŸ—ï¸ åŸºç¡€è®¾æ–½å³ä»£ç 

### IaCçš„ä¼˜åŠ¿

| ä¼ ç»Ÿæ–¹å¼ | åŸºç¡€è®¾æ–½å³ä»£ç  | ä¼˜åŠ¿ |
|----------|---------------|------|
| æ‰‹åŠ¨é…ç½®æœåŠ¡å™¨ | ä»£ç å®šä¹‰åŸºç¡€è®¾æ–½ | å¯é‡å¤ã€ä¸€è‡´æ€§ |
| æ–‡æ¡£è®°å½•é…ç½® | ä»£ç å³æ–‡æ¡£ | è‡ªåŠ¨åŒ–ã€ç‰ˆæœ¬æ§åˆ¶ |
| æ‰‹åŠ¨å¤‡ä»½æ¢å¤ | è‡ªåŠ¨åŒ–éƒ¨ç½² | å¿«é€Ÿæ¢å¤ã€ç¾éš¾æ¢å¤ |
| ç¯å¢ƒå·®å¼‚ | ç¯å¢ƒä¸€è‡´æ€§ | å‡å°‘"åœ¨æˆ‘æœºå™¨ä¸Šèƒ½è¿è¡Œ"é—®é¢˜ |

### IaCå·¥å…·å¯¹æ¯”

```mermaid
graph TB
    subgraph "é…ç½®ç®¡ç†å·¥å…·"
        Ansible[Ansible<br/>æ— ä»£ç†ã€YAMLé…ç½®]
        Chef[Chef<br/>Ruby DSLã€C/Sæ¶æ„]
        Puppet[Puppet<br/>å£°æ˜å¼ã€æ¨¡å‹é©±åŠ¨]
    end
    
    subgraph "åŸºç¡€è®¾æ–½ä¾›åº”å·¥å…·"
        Terraform[Terraform<br/>äº‘æ— å…³ã€HCLè¯­è¨€]
        CloudFormation[CloudFormation<br/>AWSåŸç”Ÿã€JSON/YAML]
        Pulumi[Pulumi<br/>å¤šè¯­è¨€æ”¯æŒã€ç¼–ç¨‹åŒ–]
    end
    
    subgraph "å®¹å™¨ç¼–æ’"
        K8s[Kubernetes<br/>å®¹å™¨ç¼–æ’å¹³å°]
        Helm[Helm<br/>K8såŒ…ç®¡ç†å™¨]
        Kustomize[Kustomize<br/>K8sé…ç½®ç®¡ç†]
    end
```

### Terraformç¤ºä¾‹

```hcl
# å®šä¹‰äº‘æä¾›å•†
provider "aws" {
  region = "us-west-2"
}

# åˆ›å»ºVPC
resource "aws_vpc" "main" {
  cidr_block           = "10.0.0.0/16"
  enable_dns_hostnames = true
  enable_dns_support   = true
  
  tags = {
    Name = "main-vpc"
    Environment = "production"
  }
}

# åˆ›å»ºEKSé›†ç¾¤
resource "aws_eks_cluster" "main" {
  name     = "main-cluster"
  role_arn = aws_iam_role.cluster.arn
  version  = "1.21"

  vpc_config {
    subnet_ids = aws_subnet.private[*].id
  }
}
```

---

## ğŸ”’ äº‘åŸç”Ÿå®‰å…¨

### å®‰å…¨æ¨¡å‹ï¼šæ·±åº¦é˜²å¾¡

```mermaid
graph TB
    subgraph "å®‰å…¨å±‚æ¬¡"
        L1[ä»£ç å®‰å…¨<br/>é™æ€åˆ†æã€ä¾èµ–æ‰«æ]
        L2[é•œåƒå®‰å…¨<br/>æ¼æ´æ‰«æã€ç­¾åéªŒè¯]
        L3[è¿è¡Œæ—¶å®‰å…¨<br/>RBACã€ç½‘ç»œç­–ç•¥]
        L4[åŸºç¡€è®¾æ–½å®‰å…¨<br/>åŠ å¯†ã€è®¿é—®æ§åˆ¶]
        L5[æ•°æ®å®‰å…¨<br/>ä¼ è¾“åŠ å¯†ã€å­˜å‚¨åŠ å¯†]
    end
    
    L1 --> L2
    L2 --> L3
    L3 --> L4
    L4 --> L5
    
    style L1 fill:#ffebee
    style L2 fill:#fce4ec
    style L3 fill:#f3e5f5
    style L4 fill:#ede7f6
    style L5 fill:#e8eaf6
```

### Kuberneteså®‰å…¨æœ€ä½³å®è·µ

#### 1. RBACæƒé™æ§åˆ¶
```yaml
# è§’è‰²å®šä¹‰
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: pod-reader
rules:
- apiGroups: [""]
  resources: ["pods"]
  verbs: ["get", "watch", "list"]

---
# è§’è‰²ç»‘å®š
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: read-pods
subjects:
- kind: User
  name: jane
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: pod-reader
  apiGroup: rbac.authorization.k8s.io
```

#### 2. ç½‘ç»œç­–ç•¥
```yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: deny-all
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress
  # é»˜è®¤æ‹’ç»æ‰€æœ‰æµé‡
```

#### 3. Podå®‰å…¨ç­–ç•¥
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: secure-pod
spec:
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    fsGroup: 2000
  containers:
  - name: app
    image: myapp:latest
    securityContext:
      allowPrivilegeEscalation: false
      readOnlyRootFilesystem: true
      capabilities:
        drop:
        - ALL
```

### é›¶ä¿¡ä»»å®‰å…¨æ¶æ„

```mermaid
graph TB
    subgraph "ä¼ ç»Ÿè¾¹ç•Œå®‰å…¨"
        Firewall[é˜²ç«å¢™]
        Internal[å†…ç½‘<br/>é»˜è®¤ä¿¡ä»»]
        External[å¤–ç½‘<br/>é»˜è®¤ä¸ä¿¡ä»»]
        
        External --> Firewall
        Firewall --> Internal
    end
    
    subgraph "é›¶ä¿¡ä»»æ¶æ„"
        Identity[èº«ä»½è®¤è¯]
        Device[è®¾å¤‡éªŒè¯]
        Network[ç½‘ç»œå¾®åˆ†æ®µ]
        Data[æ•°æ®ä¿æŠ¤]
        App[åº”ç”¨å®‰å…¨]
        
        Request[æ¯ä¸ªè¯·æ±‚] --> Identity
        Request --> Device
        Request --> Network
        Request --> Data
        Request --> App
    end
```

---

## ğŸ“š æ€»ç»“

äº‘åŸç”ŸæŠ€æœ¯ä½“ç³»æ˜¯ä¸€ä¸ªå¤æ‚ä½†å¼ºå¤§çš„æŠ€æœ¯æ ˆï¼Œå®ƒé€šè¿‡ä»¥ä¸‹æ ¸å¿ƒæ¦‚å¿µå’ŒæŠ€æœ¯ï¼Œå¸®åŠ©ç»„ç»‡æ„å»ºç°ä»£åŒ–çš„ã€å¯æ‰©å±•çš„ã€å¼¹æ€§çš„åº”ç”¨ç¨‹åºï¼š

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

1. **å®¹å™¨åŒ–**ï¼šDockeræä¾›åº”ç”¨æ‰“åŒ…å’Œéš”ç¦»
2. **ç¼–æ’**ï¼šKubernetesç®¡ç†å®¹å™¨ç”Ÿå‘½å‘¨æœŸ
3. **æœåŠ¡ç½‘æ ¼**ï¼šIstioå¤„ç†æœåŠ¡é—´é€šä¿¡
4. **ç›‘æ§**ï¼šPrometheus+Grafanaæä¾›å¯è§‚æµ‹æ€§
5. **CI/CD**ï¼šè‡ªåŠ¨åŒ–éƒ¨ç½²æµæ°´çº¿
6. **å®‰å…¨**ï¼šå¤šå±‚é˜²æŠ¤å’Œé›¶ä¿¡ä»»æ¶æ„

### å­¦ä¹ å»ºè®®

- ğŸš€ **å¾ªåºæ¸è¿›**ï¼šä»Dockerå¼€å§‹ï¼Œé€æ­¥æ·±å…¥Kubernetes
- ğŸ› ï¸ **åŠ¨æ‰‹å®è·µ**ï¼šç†è®ºç»“åˆå®é™…é¡¹ç›®
- ğŸ”„ **æŒç»­å­¦ä¹ **ï¼šäº‘åŸç”ŸæŠ€æœ¯å¿«é€Ÿå‘å±•ï¼Œéœ€è¦æŒç»­è·Ÿè¿›
- ğŸ¤ **ç¤¾åŒºå‚ä¸**ï¼šå‚ä¸å¼€æºé¡¹ç›®å’ŒæŠ€æœ¯ç¤¾åŒº

è®°ä½ï¼ŒæŒæ¡äº‘åŸç”ŸæŠ€æœ¯ä¸æ˜¯ä¸€è¹´è€Œå°±çš„è¿‡ç¨‹ï¼Œéœ€è¦æ—¶é—´ã€å®è·µå’Œè€å¿ƒã€‚ä½†ä¸€æ—¦æŒæ¡ï¼Œæ‚¨å°†å…·å¤‡æ„å»ºç°ä»£åŒ–åº”ç”¨çš„å¼ºå¤§èƒ½åŠ›ï¼ ğŸ’ª